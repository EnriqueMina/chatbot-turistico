<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>TurisAsiste ‚Äî Chatbot Tur√≠stico (Completo)</title>
<style>
  :root{
    --accent:#06b6d4;
    --card-bg:rgba(6,10,14,0.72);
    --glass: rgba(255,255,255,0.04);
    --muted:#9aa7b6;
    --light:#e6eef6;
  }
  html,body{height:100%; margin:0; font-family:Inter, system-ui, Arial;
    background:
      linear-gradient(rgba(0,0,0,0.55), rgba(0,0,0,0.75)),
      url('https://images.unsplash.com/photo-1507525428034-b723cf961d3e?q=80&w=1600&auto=format&fit=crop');
    background-size:cover;
    background-position:center;
    color:var(--light);
  }
  .app{max-width:920px; margin:28px auto; padding:18px; border-radius:12px; background:var(--card-bg); box-shadow:0 10px 40px rgba(2,6,23,0.6); backdrop-filter: blur(6px);}
  header{display:flex;align-items:center;gap:12px;margin-bottom:12px}
  .logo{width:56px;height:56px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#06b6d4);display:grid;place-items:center;font-weight:700}
  header h1{margin:0;font-size:18px}
  header p{margin:0;color:var(--muted);font-size:13px}
  .lang {margin-left:auto; display:flex; gap:8px}
  .lang button{background:transparent;border:1px solid rgba(255,255,255,0.06); color:var(--light); padding:6px 8px; border-radius:8px; cursor:pointer}
  .chat-window{height:62vh;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02)); border-radius:10px; padding:16px; overflow:auto; box-shadow: inset 0 2px 10px rgba(0,0,0,0.6);}
  .messages{display:flex;flex-direction:column;gap:12px}
  .bubble{max-width:78%;padding:12px 14px;border-radius:12px;line-height:1.35;box-shadow:0 6px 18px rgba(2,6,23,0.6);white-space:pre-wrap}
  .from-bot{align-self:flex-start;background:rgba(255,255,255,0.03);color:var(--light)}
  .from-user{align-self:flex-end;background:linear-gradient(90deg,var(--accent),#07aab0);color:#012226}
  .meta{font-size:12px;color:var(--muted);margin-bottom:6px}
  .chip-list{display:flex; gap:8px; flex-wrap:wrap; margin-top:10px}
  .chip{background:rgba(255,255,255,0.03); padding:8px 10px; border-radius:999px; cursor:pointer; color:var(--light); border:1px solid rgba(255,255,255,0.03)}
  .chip:hover{transform:translateY(-2px)}
  footer{display:flex; gap:8px; margin-top:12px; align-items:center}
  input[type="text"]{flex:1;padding:12px 14px;border-radius:999px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--light);outline:none}
  button.send{background:var(--accent); color:#012226; padding:10px 14px; border-radius:10px; border:none; cursor:pointer}
  button.clear{background:transparent;color:var(--muted);border:1px dashed rgba(255,255,255,0.04);padding:8px 10px;border-radius:8px;cursor:pointer}
  .menu{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px}
  .menu button{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:8px 10px;border-radius:10px;color:var(--light);cursor:pointer}
  .form{background:rgba(255,255,255,0.02);padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);margin-top:8px}
  a.link{color:var(--accent); text-decoration:underline}
  .small{font-size:13px;color:var(--muted)}
  @media (max-width:820px){ .app{margin:8px} .chat-window{height:65vh} }
</style>
</head>
<body>
<div class="app" role="application" aria-label="TurisAsiste chatbot">
  <header>
    <div class="logo">TA</div>
    <div>
      <h1>TurisAsiste</h1>
      <p class="small">Asistente tur√≠stico ‚Äî Informaci√≥n, reservas y soporte</p>
    </div>
    <div class="lang" role="toolbar" aria-label="Idioma">
      <button id="btn-es" aria-pressed="true">ES</button>
      <button id="btn-en">EN</button>
    </div>
  </header>

  <div class="chat-window" id="chatWindow" aria-live="polite">
    <div class="messages" id="messages"></div>
  </div>

  <div class="chip-list" id="suggerencias" aria-hidden="false"></div>

  <footer>
    <input id="inputMsg" type="text" placeholder="Escribe tu pregunta o elige una opci√≥n..." />
    <button class="send" id="sendBtn">Enviar</button>
    <button class="clear" id="clearBtn" title="Limpiar conversaci√≥n">Limpiar</button>
  </footer>

  <div style="margin-top:10px" class="small">Sugerencias r√°pidas: <span id="quickHint" style="color:var(--accent)"></span></div>
</div>

<script>
/* ---------------------- Texto / Datos (ES / EN) ---------------------- */
const LANG = { ES:'es', EN:'en' };
let currentLang = LANG.ES;

const DATA = {
  es: {
    greeting: "üëã ¬°Hola! Soy TurisAsiste, tu asistente tur√≠stico virtual üå¥\n¬øEn qu√© puedo ayudarte hoy?",
    menu: ["üèñÔ∏è Informaci√≥n sobre destinos","üõèÔ∏è Reservar alojamiento o tour","üçΩÔ∏è Recomendaciones gastron√≥micas","üöå Transporte y c√≥mo llegar","üìÖ Actividades disponibles","üí¨ Preguntas frecuentes","‚ùå Salir"],
    destinos: ["Cove√±as","Cartagena","Santa Marta"],
    destino_info: {
      "Cove√±as": "üåä Cove√±as es un destino costero ideal para el descanso. Puedes visitar sus playas, el Museo Marina y el Parque Natural San Bernardo.\nClima promedio: 28¬∞C ‚òÄÔ∏è",
      "Cartagena": "üè∞ Cartagena: ciudad amurallada, historia colonial, murallas y vida nocturna vibrante.\nClima promedio: 30¬∞C.",
      "Santa Marta": "üåÖ Santa Marta: cercana al Parque Tayrona y Minca, ideal para ecoturismo y aventura.\nClima promedio: 29¬∞C."
    },
    reservar_prompt: "üè† ¬°Perfecto! ¬øQu√© te gustar√≠a reservar?\n- Tour guiado\n- Hotel\n- Transporte",
    reservar_confirm: "üëâ Te redirijo al formulario de reserva (simulado). Tambi√©n puedo darte una lista de opciones disponibles.",
    gastronomy: [
      "Cove√±as: Restaurante Donde Mar√≠a ‚Äì especialidad en mariscos.",
      "Cartagena: La Mulata ‚Äì comida t√≠pica caribe√±a.",
      "Santa Marta: Ouzo ‚Äì cocina mediterr√°nea."
    ],
    transporte: "üöå Puedes llegar en bus, carro particular o avi√≥n (a Monter√≠a y luego 2h hasta Cove√±as).\nüöó Tambi√©n puedo mostrarte un mapa interactivo o darte el costo promedio de transporte.",
    activities: [
      "Paseo en lancha a las islas.",
      "Buceo y snorkel.",
      "Tour ecol√≥gico por los manglares.",
      "Paseo en bicicleta por la zona costera."
    ],
    faq: [
      {q: "¬øCu√°l es la mejor √©poca para visitar?", a: "üëâ Entre diciembre y marzo, cuando hay menos lluvias."},
      {q: "¬øSe puede pagar en d√≥lares?", a: "üëâ S√≠, la mayor√≠a de hoteles y agencias aceptan d√≥lares o tarjetas internacionales."},
      {q: "¬øEs seguro viajar solo/a?", a: "üëâ S√≠, aunque se recomienda usar transporte oficial y evitar zonas solitarias en la noche."}
    ],
    goodbye: "üòä ¬°Gracias por usar TurisAsiste!\nEspero que tengas un viaje inolvidable. üå¥"
  },
  en: {
    greeting: "üëã Hi! I'm TurisAsiste, your travel assistant üå¥\nHow can I help you today?",
    menu: ["üèñÔ∏è Destination info","üõèÔ∏è Book hotel or tour","üçΩÔ∏è Food recommendations","üöå Transport & how to arrive","üìÖ Available activities","üí¨ FAQ","‚ùå Exit"],
    destinos: ["Cove√±as","Cartagena","Santa Marta"],
    destino_info: {
      "Cove√±as": "üåä Cove√±as is a coastal destination ideal for relaxation. Visit the beaches, the Marina Museum and San Bernardo Natural Park.\nAvg temp: 28¬∞C ‚òÄÔ∏è",
      "Cartagena": "üè∞ Cartagena: walled city, colonial history and lively nightlife.\nAvg temp: 30¬∞C.",
      "Santa Marta": "üåÖ Santa Marta: near Tayrona Park and Minca, great for ecotourism and adventure.\nAvg temp: 29¬∞C."
    },
    reservar_prompt: "üè† Great! What would you like to book?\n- Guided tour\n- Hotel\n- Transport",
    reservar_confirm: "üëâ I'll redirect you to the booking form (simulated). I can also list available options.",
    gastronomy: [
      "Cove√±as: Donde Mar√≠a ‚Äì seafood specialty.",
      "Cartagena: La Mulata ‚Äì typical Caribbean food.",
      "Santa Marta: Ouzo ‚Äì Mediterranean cuisine."
    ],
    transporte: "üöå You can get there by bus, private car or plane (to Monter√≠a then ~2h to Cove√±as).\nüöó I can show a map or give an estimated transport cost.",
    activities: [
      "Boat trips to nearby islands.",
      "Diving and snorkeling.",
      "Ecological mangrove tours.",
      "Coastal bike rides."
    ],
    faq: [
      {q: "What's the best time to visit?", a: "üëâ December to March, when there is less rain."},
      {q: "Can I pay in dollars?", a: "üëâ Yes, many hotels and agencies accept dollars or international cards."},
      {q: "Is it safe to travel alone?", a: "üëâ Yes, but use official transport and avoid isolated areas at night."}
    ],
    goodbye: "üòä Thanks for using TurisAsiste!\nHave an unforgettable trip. üå¥"
  }
};

/* ---------------------- Utils & UI ---------------------- */
const messagesEl = document.getElementById("messages");
const inputEl = document.getElementById("inputMsg");
const sendBtn = document.getElementById("sendBtn");
const clearBtn = document.getElementById("clearBtn");
const suggerenciasEl = document.getElementById("suggerencias");
const quickHint = document.getElementById("quickHint");
const btnES = document.getElementById("btn-es");
const btnEN = document.getElementById("btn-en");

function appendBubble(text, from="bot"){
  const wrap = document.createElement("div");
  wrap.className = "bubble " + (from==="user" ? "from-user":"from-bot");
  const meta = document.createElement("div"); meta.className="meta";
  meta.textContent = from==="user"? (currentLang===LANG.ES?"T√∫":"You") : "TurisAsiste";
  const content = document.createElement("div"); content.innerText = text;
  wrap.appendChild(meta); wrap.appendChild(content);
  messagesEl.appendChild(wrap);
  messagesEl.scrollTop = messagesEl.scrollHeight;
}

/* initialize UI and chips */
const suggestionList = [ ...DATA.es.destinos, "Reservar", "Gastronom√≠a", "Transporte", "Actividades", "FAQ" ];
function initChips(){
  suggerenciasEl.innerHTML="";
  suggestionList.forEach(s => {
    const c = document.createElement("div");
    c.className="chip"; c.textContent = s;
    c.addEventListener("click", ()=>{ inputEl.value = s; userSend(); });
    suggerenciasEl.appendChild(c);
  });
  quickHint.textContent = suggestionList[0];
}

/* language toggle */
btnES.onclick = ()=>{ currentLang = LANG.ES; btnES.setAttribute("aria-pressed","true"); btnEN.setAttribute("aria-pressed","false"); refreshLanguage(); };
btnEN.onclick = ()=>{ currentLang = LANG.EN; btnEN.setAttribute("aria-pressed","true"); btnES.setAttribute("aria-pressed","false"); refreshLanguage(); };

function refreshLanguage(){
  messagesEl.innerHTML = "";
  startConversation();
  initChips();
}

/* start */
function startConversation(){
  appendBubble(DATA[currentLang].greeting, "bot");
  // show menu buttons
  setTimeout(showMainMenu, 600);
}

/* Main menu (rendered as chips/buttons inside chat) */
function showMainMenu(){
  const menu = DATA[currentLang].menu;
  // append a small instruction
  appendBubble((currentLang===LANG.ES?"Selecciona una opci√≥n del men√∫ o escribe tu petici√≥n.":"Choose an option or type your request."), "bot");
  // render menu as buttons
  const menuWrap = document.createElement("div");
  menuWrap.className = "menu";
  menu.forEach((m, idx) => {
    const b = document.createElement("button");
    b.textContent = m;
    b.onclick = ()=>menuSelect(idx);
    menuWrap.appendChild(b);
  });
  const wrapperBubble = document.createElement("div");
  wrapperBubble.className = "bubble from-bot";
  wrapperBubble.style.padding = "12px";
  wrapperBubble.appendChild(menuWrap);
  messagesEl.appendChild(wrapperBubble);
  messagesEl.scrollTop = messagesEl.scrollHeight;
}

/* menu select handling (indexes correspond to DATA menu) */
function menuSelect(index){
  // 0 Destinos, 1 Reservar, 2 Gastronomia, 3 Transporte, 4 Actividades, 5 FAQ, 6 Salir
  const keyMap = {0:'destinos',1:'reservar',2:'gastronomia',3:'transporte',4:'actividades',5:'faq',6:'salir'};
  const key = keyMap[index];
  switch(key){
    case 'destinos': openDestinos(); break;
    case 'reservar': openReservar(); break;
    case 'gastronomia': openGastronomia(); break;
    case 'transporte': openTransporte(); break;
    case 'actividades': openActividades(); break;
    case 'faq': openFAQ(); break;
    case 'salir': doExit(); break;
  }
}

/* Destinos flow */
function openDestinos(){
  appendBubble(currentLang===LANG.ES? "üèùÔ∏è ¬øQu√© destino te interesa?":"üèùÔ∏è Which destination interests you?", "bot");
  // create choices
  const wrap = document.createElement("div"); wrap.className="menu";
  DATA[currentLang].destinos.forEach(d=>{
    const b = document.createElement("button"); b.textContent = d;
    b.onclick = ()=>selectDestino(d);
    wrap.appendChild(b);
  });
  const bubble = document.createElement("div"); bubble.className="bubble from-bot"; bubble.appendChild(wrap);
  messagesEl.appendChild(bubble);
  messagesEl.scrollTop = messagesEl.scrollHeight;
}
function selectDestino(dest){
  appendBubble(dest, "user");
  const info = DATA[currentLang].destino_info[dest] || (currentLang===LANG.ES?"Info no disponible":"Info not available");
  appendBubble(info, "bot");
  // offer next options
  const wrap = document.createElement("div"); wrap.className="menu";
  const a1 = document.createElement("button"); a1.textContent = currentLang===LANG.ES? "Ver actividades":"See activities"; a1.onclick = openActividades;
  const a2 = document.createElement("button"); a2.textContent = currentLang===LANG.ES? "Ver restaurantes":"See restaurants"; a2.onclick = openGastronomia;
  const a3 = document.createElement("button"); a3.textContent = currentLang===LANG.ES? "Volver al men√∫":"Back to menu"; a3.onclick = showMainMenu;
  [a1,a2,a3].forEach(x=>wrap.appendChild(x));
  const bubble = document.createElement("div"); bubble.className="bubble from-bot"; bubble.appendChild(wrap);
  messagesEl.appendChild(bubble);
  messagesEl.scrollTop = messagesEl.scrollHeight;
}

/* Reservar flow (form simulated) */
function openReservar(){
  appendBubble(DATA[currentLang].reservar_prompt, "bot");
  // show options (Tour/Hotel/Transport)
  const wrap = document.createElement("div"); wrap.className="menu";
  const opts = (currentLang===LANG.ES?["Tour guiado","Hotel","Transporte"]:["Guided tour","Hotel","Transport"]);
  opts.forEach(opt=>{
    const b=document.createElement("button"); b.textContent=opt; b.onclick=()=>startBooking(opt);
    wrap.appendChild(b);
  });
  const bubble = document.createElement("div"); bubble.className="bubble from-bot"; bubble.appendChild(wrap);
  messagesEl.appendChild(bubble);
  messagesEl.scrollTop = messagesEl.scrollHeight;
}
function startBooking(type){
  appendBubble(type, "user");
  appendBubble(DATA[currentLang].reservar_confirm, "bot");
  // show small form
  const form = document.createElement("div"); form.className="form";
  form.innerHTML = `
    <label>${currentLang===LANG.ES?'Nombre':'Name'}:<br><input id="bk-name" style="width:100%;padding:8px;margin-top:6px;border-radius:6px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:var(--light)"></label>
    <label style="display:block;margin-top:8px">${currentLang===LANG.ES?'Correo':'Email'}:<br><input id="bk-email" style="width:100%;padding:8px;margin-top:6px;border-radius:6px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:var(--light)"></label>
    <label style="display:block;margin-top:8px">${currentLang===LANG.ES?'Fecha':'Date'}:<br><input id="bk-date" type="date" style="width:100%;padding:8px;margin-top:6px;border-radius:6px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:var(--light)"></label>
    <div style="display:flex;gap:8px;margin-top:10px">
      <button id="bk-send" style="padding:8px 10px;border-radius:8px;background:linear-gradient(90deg,var(--accent),#06b6d4);color:#012226;border:none;cursor:pointer">${currentLang===LANG.ES?'Enviar':'Submit'}</button>
      <button id="bk-cancel" style="padding:8px 10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:var(--light);cursor:pointer">${currentLang===LANG.ES?'Cancelar':'Cancel'}</button>
    </div>
  `;
  const bubble = document.createElement("div"); bubble.className="bubble from-bot"; bubble.appendChild(form);
  messagesEl.appendChild(bubble);
  messagesEl.scrollTop = messagesEl.scrollHeight;
  document.getElementById("bk-send").onclick = ()=>{
    const name = document.getElementById("bk-name").value || "-";
    const email = document.getElementById("bk-email").value || "-";
    const date = document.getElementById("bk-date").value || "-";
    appendBubble(`${currentLang===LANG.ES?'Reserva':'Booking'}: ${type} ‚Äî ${name}`, "user");
    appendBubble(currentLang===LANG.ES? `Gracias ${name}. Recibimos tu solicitud para ${type}. Te contactaremos al ${email}.` : `Thanks ${name}. We received your request for ${type}. We'll contact you at ${email}.`, "bot");
    setTimeout(showMainMenu, 800);
  };
  document.getElementById("bk-cancel").onclick = ()=>{ appendBubble(currentLang===LANG.ES?'Reserva cancelada.':'Booking cancelled.', 'bot'); setTimeout(showMainMenu,600); };
}

/* Gastronom√≠a flow */
function openGastronomia(){
  appendBubble(currentLang===LANG.ES? "üç§ Aqu√≠ tienes las mejores recomendaciones locales:" : "üç§ Here are the top local recommendations:", "bot");
  DATA[currentLang].gastronomy.forEach(r=>{
    const btn = document.createElement("button"); btn.className="menu-btn"; btn.textContent = r;
    // show as bubble line with button to ask for address
    appendBubble(r, "bot");
  });
  // Add follow actions
  const wrap = document.createElement("div"); wrap.className="menu";
  const dirBtn = document.createElement("button"); dirBtn.textContent = currentLang===LANG.ES? "¬øQuieres la direcci√≥n?":"Do you want the address?"; dirBtn.onclick = ()=>appendBubble(currentLang===LANG.ES? "Direcci√≥n ejemplo: Calle 1 #2-3, Centro.":"Sample address: Street 1 #2-3, Downtown.", "bot");
  const back = document.createElement("button"); back.textContent = currentLang===LANG.ES? "Volver al men√∫":"Back to menu"; back.onclick = showMainMenu;
  wrap.appendChild(dirBtn); wrap.appendChild(back);
  const bubble = document.createElement("div"); bubble.className="bubble from-bot"; bubble.appendChild(wrap);
  messagesEl.appendChild(bubble);
  messagesEl.scrollTop = messagesEl.scrollHeight;
}

/* Transporte */
function openTransporte(){
  appendBubble(DATA[currentLang].transporte, "bot");
  const wrap = document.createElement("div"); wrap.className="menu";
  const dir = document.createElement("button"); dir.textContent = currentLang===LANG.ES? "Direcciones" : "Directions"; dir.onclick = ()=>appendBubble(currentLang===LANG.ES? "Desde Monter√≠a: tomar la v√≠a X ... (2h en carro)":"From Monter√≠a: take road X ... (2h by car)", "bot");
  const cost = document.createElement("button"); cost.textContent = currentLang===LANG.ES? "Costo estimado" : "Cost estimate"; cost.onclick = ()=>appendBubble(currentLang===LANG.ES? "Costo aproximado en bus: COP 30,000 - 50,000" : "Approx cost by bus: COP 30,000 - 50,000", "bot");
  const map = document.createElement("button"); map.textContent = currentLang===LANG.ES? "Mostrar mapa":"Show map"; map.onclick = ()=>appendBubble(currentLang===LANG.ES? "Mapa interactivo: [enlace]" : "Interactive map: [link]", "bot");
  const back = document.createElement("button"); back.textContent = currentLang===LANG.ES? "Volver al men√∫":"Back to menu"; back.onclick = showMainMenu;
  [dir,cost,map,back].forEach(x=>wrap.appendChild(x));
  const bubble = document.createElement("div"); bubble.className="bubble from-bot"; bubble.appendChild(wrap);
  messagesEl.appendChild(bubble);
  messagesEl.scrollTop = messagesEl.scrollHeight;
}

/* Actividades */
function openActividades(){
  appendBubble(currentLang===LANG.ES? "üìÖ Estas son las actividades m√°s populares:" : "üìÖ These are the most popular activities:", "bot");
  DATA[currentLang].activities.forEach(a=>appendBubble("‚Ä¢ "+a, "bot"));
  const wrap = document.createElement("div"); wrap.className="menu";
  const boat = document.createElement("button"); boat.textContent = currentLang===LANG.ES? "Paseo en lancha" : "Boat trip"; boat.onclick = ()=>appendBubble(currentLang===LANG.ES? "Duraci√≥n: 4 horas. Precio aproximado: COP 60,000" : "Duration: 4h. Price approx: COP 60,000", "bot");
  const dive = document.createElement("button"); dive.textContent = currentLang===LANG.ES? "Buceo" : "Diving"; dive.onclick = ()=>appendBubble(currentLang===LANG.ES? "Requiere reserva previa y certificaci√≥n." : "Requires prior booking and certification.", "bot");
  const back = document.createElement("button"); back.textContent = currentLang===LANG.ES? "Volver al men√∫" : "Back to menu"; back.onclick = showMainMenu;
  [boat,dive,back].forEach(x=>wrap.appendChild(x));
  const bubble = document.createElement("div"); bubble.className="bubble from-bot"; bubble.appendChild(wrap);
  messagesEl.appendChild(bubble);
  messagesEl.scrollTop = messagesEl.scrollHeight;
}

/* FAQ */
function openFAQ(){
  appendBubble(currentLang===LANG.ES? "üí¨ Preguntas frecuentes:" : "üí¨ Frequently asked questions:", "bot");
  DATA[currentLang].faq.forEach(f=>{
    appendBubble("Q: "+f.q+"\nA: "+f.a, "bot");
  });
  const back = document.createElement("div"); back.className="menu";
  const b = document.createElement("button"); b.textContent = currentLang===LANG.ES? "Volver al men√∫":"Back to menu"; b.onclick = showMainMenu; back.appendChild(b);
  const bubble = document.createElement("div"); bubble.className="bubble from-bot"; bubble.appendChild(back);
  messagesEl.appendChild(bubble);
  messagesEl.scrollTop = messagesEl.scrollHeight;
}

/* Exit */
function doExit(){
  appendBubble(DATA[currentLang].goodbye, "bot");
  setTimeout(()=>{ messagesEl.innerHTML = ""; startConversation(); }, 1600);
}

/* Free text handler: try to route common keywords to flows */
function handleFreeText(text){
  const t = text.toLowerCase();
  if(t.includes("cove")||t.includes("covenas")){ selectDestino("Cove√±as"); return; }
  if(t.includes("cartagena")){ selectDestino("Cartagena"); return; }
  if(t.includes("santa")){ selectDestino("Santa Marta"); return; }
  if(t.includes("reserv")||t.includes("book")){ openReservar(); return; }
  if(t.includes("gastr")||t.includes("rest")){ openGastronomia(); return; }
  if(t.includes("transport")||t.includes("bus")||t.includes("taxi")){ openTransporte(); return; }
  if(t.includes("activ")||t.includes("tour")||t.includes("buceo")){ openActividades(); return; }
  if(t.includes("faq")||t.includes("pregunta")){ openFAQ(); return; }
  // fallback
  appendBubble(currentLang===LANG.ES? "Perdona, no entend√≠ exactamente. ¬øQuieres ver el men√∫?" : "Sorry, I didn't get that. Would you like to see the menu?", "bot");
  const b = document.createElement("button"); b.textContent = currentLang===LANG.ES? "Ver men√∫":"Show menu"; b.onclick = showMainMenu;
  const wrap = document.createElement("div"); wrap.className="menu"; wrap.appendChild(b);
  const bubble = document.createElement("div"); bubble.className="bubble from-bot"; bubble.appendChild(wrap);
  messagesEl.appendChild(bubble);
  messagesEl.scrollTop = messagesEl.scrollHeight;
}

/* input handling */
function userSend(){
  const v = inputEl.value.trim();
  if(!v) return;
  appendBubble(v, "user");
  inputEl.value = "";
  setTimeout(()=> handleFreeText(v), 350);
}
sendBtn.addEventListener("click", userSend);
inputEl.addEventListener("keydown", e=>{ if(e.key==="Enter") userSend(); });
clearBtn.addEventListener("click", ()=>{ messagesEl.innerHTML=""; startConversation(); });

/* init */
function init(){
  startConversation();
  initChips();
}
init();
</script>
</body>
</html>
